From 942050f3f323a34c5e6e2ea3ff5851e321484214 Mon Sep 17 00:00:00 2001
From: Guy Harris <guy@alum.mit.edu>
Date: Wed, 5 Nov 2014 23:14:58 -0800
Subject: [PATCH 6/6] There's no pcap_t argument to code generator routines.

Use the global bpf_pcap instead.
---
 gencode.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/gencode.c b/gencode.c
index d0b5b1a..1e38186 100644
--- a/gencode.c
+++ b/gencode.c
@@ -7967,7 +7967,7 @@ gen_vlan(vlan_num)
 			/*
 			 * Do we need special VLAN handling?
 			 */
-                	if (p->bpf_codegen_flags & BPF_SPECIAL_VLAN_HANDLING)
+			if (bpf_pcap->bpf_codegen_flags & BPF_SPECIAL_VLAN_HANDLING)
 				b0 = gen_vlan_bpf_extensions(vlan_num);
 			else
 				b0 = gen_vlan_no_bpf_extensions(vlan_num);
-- 
1.8.3.1

